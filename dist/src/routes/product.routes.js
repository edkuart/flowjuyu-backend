"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const express_1 = require("express");
const auth_1 = require("../middleware/auth");
const requireActiveSeller_1 = require("../middleware/requireActiveSeller");
const multerProducts_1 = require("../middleware/multerProducts");
const asyncHandler_1 = __importDefault(require("../middleware/asyncHandler"));
const product_controller_1 = require("../controllers/product.controller");
const router = (0, express_1.Router)();
router.get("/categorias", (0, asyncHandler_1.default)(product_controller_1.getCategorias));
router.get("/clases", (0, asyncHandler_1.default)(product_controller_1.getClases));
router.get("/regiones", (0, asyncHandler_1.default)(product_controller_1.getRegiones));
router.get("/telas", (0, asyncHandler_1.default)(product_controller_1.getTelas));
router.get("/accesorios", (0, asyncHandler_1.default)(product_controller_1.getAccesorios));
router.get("/accesorio-tipos", (0, asyncHandler_1.default)(product_controller_1.getAccesorioTipos));
router.get("/accesorio-materiales", (0, asyncHandler_1.default)(product_controller_1.getAccesorioMateriales));
router.get("/products", (0, asyncHandler_1.default)(product_controller_1.getFilteredProducts));
router.get("/productos", (0, asyncHandler_1.default)(product_controller_1.getFilteredProducts));
router.get("/filters/:tipo", (0, asyncHandler_1.default)(product_controller_1.getFilters));
router.get("/categorias/:slug/productos", (0, asyncHandler_1.default)(product_controller_1.getProductsByCategory));
router.get("/productos/nuevos", (0, asyncHandler_1.default)(product_controller_1.getNewProducts));
router.get("/products/trending", (0, asyncHandler_1.default)(product_controller_1.getTrendingProducts));
router.get("/products/top-by-category/:categoriaId", (0, asyncHandler_1.default)(product_controller_1.getTopProductsByCategory));
router.get("/products/:id", (0, asyncHandler_1.default)(product_controller_1.getProductById));
router.get("/productos/:id", (0, asyncHandler_1.default)(product_controller_1.getProductById));
router.get("/products/:id/reviews", (0, asyncHandler_1.default)(product_controller_1.getProductReviews));
router.post("/products/:id/reviews", (0, auth_1.verifyToken)(["buyer"]), (0, auth_1.requireRole)("buyer"), (0, asyncHandler_1.default)(product_controller_1.createProductReview));
router.post("/productos", (0, auth_1.verifyToken)(["seller"]), (0, auth_1.requireRole)("seller"), requireActiveSeller_1.requireActiveSeller, multerProducts_1.uploadProductImages.array("imagenes[]", 5), (0, asyncHandler_1.default)(product_controller_1.createProduct));
router.get("/seller/products", (0, auth_1.verifyToken)(["seller"]), (0, auth_1.requireRole)("seller"), requireActiveSeller_1.requireActiveSeller, (0, asyncHandler_1.default)(product_controller_1.getSellerProducts));
router.get("/productos/:id/edit", (0, auth_1.verifyToken)(["seller"]), (0, auth_1.requireRole)("seller"), requireActiveSeller_1.requireActiveSeller, (0, asyncHandler_1.default)(product_controller_1.getProductForEdit));
router.put("/productos/:id", (0, auth_1.verifyToken)(["seller"]), (0, auth_1.requireRole)("seller"), requireActiveSeller_1.requireActiveSeller, multerProducts_1.uploadProductImages.array("imagenes[]", 5), (0, asyncHandler_1.default)(product_controller_1.updateProduct));
router.patch("/productos/:id/set-principal", (0, auth_1.verifyToken)(["seller"]), (0, auth_1.requireRole)("seller"), requireActiveSeller_1.requireActiveSeller, (0, asyncHandler_1.default)(product_controller_1.setPrincipalImage));
router.patch("/productos/:id/activo", (0, auth_1.verifyToken)(["seller"]), (0, auth_1.requireRole)("seller"), requireActiveSeller_1.requireActiveSeller, (0, asyncHandler_1.default)(product_controller_1.toggleProductActive));
router.delete("/productos/:id", (0, auth_1.verifyToken)(["seller"]), (0, auth_1.requireRole)("seller"), requireActiveSeller_1.requireActiveSeller, (0, asyncHandler_1.default)(product_controller_1.deleteProduct));
router.delete("/productos/:id/imagenes/:imageId", (0, auth_1.verifyToken)(["seller"]), (0, auth_1.requireRole)("seller"), requireActiveSeller_1.requireActiveSeller, (0, asyncHandler_1.default)(product_controller_1.deleteProductImage));
exports.default = router;
